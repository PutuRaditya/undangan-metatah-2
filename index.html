<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no"
    />
    <title>Undangan Metatah 2</title>

    <!-- Bootstrap CSS & Icons -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css"
    />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Ancizar+Serif&display=swap"
      rel="stylesheet"
    />

    <!-- Simply Countdown -->
    <link rel="stylesheet" href="countdown/simplyCountdown.theme.default.css" />
    <script src="countdown/simplyCountdown.min.js"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <section class="hero locked" id="hero">
      <img src="img/mandala-op15-2.webp" alt="Mandala" class="mandala-bg" />
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8 col-lg-7">
            <img
              src="img/bunga-1.webp"
              alt="Ornamen Kanan Bawah"
              class="ornamen ornamen-kanan"
            />
            <img
              src="img/bunga-2.webp"
              alt="Ornamen Kiri Atas"
              class="ornamen ornamen-kiri"
            />
            <h1>Undangan Metatah</h1>
            <h2>Radit & Nara</h2>
            <h3>Kepada</h3>
            <p>Bapak/Ibu/Saudara/i</p>
            <h3><span>Nama</span></h3>
            <a href="#home" class="btn btn-custom mt-4" onclick="enableScroll()"
              >Buka Undangan</a
            >
          </div>
        </div>
      </div>
    </section>

    <section class="home" id="home">
      <div class="container-fluid px-4">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8 col-lg-7">
            <img src="img/ornamen-batas.webp" alt="Batas" class="batas1" />
            <h1>Om Swastyastu</h1>
            <p class="p1">
              Atas Asung Kertha Wara Nugraha Ida Sang Hyang Widhi Wasa kami
              bermaksud mengundang Bapak/Ibu/Saudara/i pada Upacara Manusa
              Yadnya Metatah (Potong Gigi) Putra-putra kami.
            </p>
            <h2>I Putu Raditya Perdana Putra</h2>
            <h2>I Made Narendra Dwi Putra</h2>
            <p class="p2">Putra dari pasangan</p>
            <h3>I Ketut Murjana, S.E. dan Ni Nyoman Artiniasih</h3>
          </div>
        </div>
      </div>
    </section>
    <section class="time" id="time">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8 col-lg-7 text-center">
            <img
              src="img/ornamen-batas.webp"
              alt="Ornamen Batas - Hero dengan Home"
              class="batas1"
            />
            <h1>Waktu dan Tempat</h1>
            <div class="d-flex justify-content-center">
              <div class="card text-center">
                <div class="card-body">
                  <!-- <h1 class="card-title">Waktu dan Tempat</h1> -->
                  <h2>Minggu, 24 Agustus 2025</h2>
                  <h3>15.00 WITA - Selesai</h3>
                  <h3>
                    Jl. Anggrek II No.11, Lingk. Tegal Saat, Kapal, Mengwi,
                    Badung
                  </h3>
                  <!-- <p class="card-text">
                    With supporting text below as a natural lead-in to
                    additional content.
                  </p> -->
                  <a
                    href="https://maps.app.goo.gl/8fUgaNSVSTqdXmD79"
                    class="btn btn-primary"
                    >Maps Lokasi</a
                  >
                </div>
              </div>
            </div>
            <p>
              Merupakan suatu kebahagiaan dan kehormatan bagi kami apabila
              Bapak/ Ibu/ Saudara/i berkenan hadir untuk memberikan doa restu.
            </p>
            <p>Atas kehadiran dan doa restunya kami ucapkan terimakasih</p>
            <h4>Om Shanti, Shanti, Shanti Om</h4>
            <h5>Menuju Acara</h5>

            <div class="simply-countdown"></div>
          </div>
        </div>
      </div>
    </section>
    <section class="rsvp" id="rsvp">
      <div class="container-fluid px-4">
        <div class="row justify-content-center">
          <div class="col-12 col-md-8 col-lg-7">
            <img
              src="img/ornamen-batas.webp"
              alt="Ornamen Batas - Hero dengan Home"
              class="batas1"
            />
            <h2>Mohon Doa Restu</h2>
            <form
              method="POST"
              id="my-form"
              action="https://script.google.com/macros/s/AKfycby95I8qm6qRyBYbC-m8-xROdjgb7hIxVxXAq6vohYwr7KkIf02PlEjkWI3zL-X_kQgt/exec"
            >
              <div class="mb-3">
                <label for="nama" class="form-label">Masukan Namamu</label>
                <input type="nama" class="form-control" id="nama" name="nama" />
              </div>
              <div class="mb-3">
                <label for="ucapan" class="form-label">Berikan Ucapanmu</label>
                <textarea
                  type="ucapan"
                  class="form-control"
                  id="ucapan"
                  name="ucapan"
                ></textarea>
              </div>
              <div class="mb-3">
                <label for="kehadiran" class="form-label"
                  >Konfirmasi Kehadiran</label
                >

                <select name="kehadiran" id="kehadiran" class="form-select">
                  <option selected>Pilih salah satu</option>
                  <option value="Hadir">Hadir</option>
                  <option value="Tidak Hadir">Tidak Hadir</option>
                  <option value="Ragu-ragu">Ragu-ragu</option>
                </select>
              </div>
              <button type="submit" class="btn btn-kirim">Kirim Ucapan</button>
            </form>
            <div
              id="notifikasiUcapan"
              class="alert text-center mt-3 d-none"
            ></div>

            <ul id="ucapanContainer"></ul>
          </div>
        </div>
      </div>
    </section>
    <footer>
      <div class="container">
        <div class="row">
          <div class="col">
            <p>Create by Putu Raditya &copy 2025</p>
            <ul>
              <li>
                <a href="https://www.instagram.com/putuepung/"
                  ><i class="bi bi-instagram"></i
                ></a>
              </li>
              <li>
                <a href="https://wa.me/6281239007868"
                  ><i class="bi bi-whatsapp"></i
                ></a>
              </li>
              <li>
                <a href="https://www.facebook.com/putu.raditya.7773"
                  ><i class="bi bi-facebook"></i
                ></a>
              </li>
              <li>
                <a
                  href="https://www.linkedin.com/in/putu-raditya-perdana-putra/"
                  ><i class="bi bi-linkedin"></i
                ></a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

    <div id="audio-container">
      <audio id="song" autoplay loop>
        <source src="audio/beauty-in-colors-gus-teja.mp3" type="audio/mp3" />
      </audio>

      <div class="audio-icon-wrapper" style="display: none">
        <i class="bi bi-disc"></i>
      </div>
    </div>

    <script src="script.js"></script>

    <!-- SimplyCountdown Script -->

    <script>
      simplyCountdown(".simply-countdown", {
        year: 2025, // required
        month: 11, // required
        day: 7, // required
        hours: 7, // Default is 0 [0-23] integer

        words: {
          //words displayed into the countdown
          days: { singular: "hari", plural: "hari" },
          hours: { singular: "jam", plural: "jam" },
          minutes: { singular: "menit", plural: "menit" },
          seconds: { singular: "detik", plural: "detik" },
        },
      });
    </script>

    <!-- Script Ucapan Doa  -->

    <script>
      window.addEventListener("load", function () {
        const form = document.getElementById("my-form");
        const notifikasi = document.getElementById("notifikasiUcapan");

        form.addEventListener("submit", function (e) {
          e.preventDefault();

          // Ubah tombol jadi loading
          const tombol = form.querySelector("button");
          const teksAwal = tombol.innerHTML;
          tombol.disabled = true;
          tombol.innerHTML = `<span class="spinner-border spinner-border-sm me-2"></span> Mengirim...`;

          const data = new FormData(form);
          const action = form.action;

          fetch(action, {
            method: "POST",
            body: data,
          })
            .then((response) => {
              if (response.ok) {
                tampilkanNotifikasi("Ucapan sudah tersampaikan ❤️", "success");
                form.reset();
              } else {
                throw new Error("Gagal mengirim");
              }
            })
            .catch((error) => {
              console.error(error);
              tampilkanNotifikasi(
                "Gagal mengirim ucapan. Silakan coba lagi.",
                "danger"
              );
            })
            .finally(() => {
              tombol.disabled = false;
              tombol.innerHTML = teksAwal;
            });
        });

        function tampilkanNotifikasi(pesan, tipe) {
          notifikasi.textContent = pesan;
          notifikasi.className = `alert alert-${tipe} text-center mt-3`;
          setTimeout(() => {
            notifikasi.className += " d-none";
          }, 4000); // sembunyikan setelah 4 detik
        }
      });
    </script>

    <!-- Scrip menampilkan ucapan Doa -->

    <script>
      const GOOGLE_SCRIPT_URL =
        "https://script.google.com/macros/s/AKfycby95I8qm6qRyBYbC-m8-xROdjgb7hIxVxXAq6vohYwr7KkIf02PlEjkWI3zL-X_kQgt/exec";

      document.addEventListener("DOMContentLoaded", function () {
        fetch(GOOGLE_SCRIPT_URL)
          .then((res) => res.json())
          .then((data) => {
            // Membalik data agar terbaru di atas
            data.reverse().forEach((item) => {
              if (item.nama && item.ucapan && item.kehadiran) {
                tampilkanUcapan(item.nama, item.kehadiran, item.ucapan);
              }
            });
          })
          .catch((err) => console.error("Gagal mengambil data:", err));
      });

      function tampilkanUcapan(nama, kehadiran, ucapan) {
        const li = document.createElement("li");
        li.innerHTML = `<strong>${nama}</strong> (${kehadiran})<br>${ucapan}`;
        document.getElementById("ucapanContainer").appendChild(li);
      }
    </script>

    <!-- Script Ubah Nama Undangan -->

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const nama = urlParams.get("nama") || "";

      // const pronoun = urlParams.get("p") || "Bapak/Ibu/Saudara/i";
      // console.log(nama);

      const namaContainer = document.querySelector(".hero h3 span");

      namaContainer.innerText = `${nama}`.replace(/ ,$/, ",");

      document.querySelector("#nama").value = nama;
    </script>

    <!-- Script Audio dan Kunci Halaman Awal -->

    <script>
      const rootElement = document.querySelector(":root");
      const audioIconWrapper = document.querySelector(".audio-icon-wrapper");
      const audioIcon = document.querySelector(".audio-icon-wrapper i");
      const song = document.querySelector("#song");
      let isPlaying = false;

      function preventTouch(e) {
        e.preventDefault();
      }

      function disableScroll() {
        scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        scrollLeft = window.pageXOffset || document.documentElement.scrollLeft;

        window.onscroll = function () {
          window.scrollTo(scrollTop, scrollLeft);
        };

        document.body.addEventListener("touchmove", preventTouch, {
          passive: false,
        });
        document.body.classList.add("scroll-lock");
        document.querySelector(".hero").classList.add("locked");
      }

      function enableScroll() {
        window.onscroll = null;
        document.body.removeEventListener("touchmove", preventTouch);
        document.body.classList.remove("scroll-lock");

        const hero = document.querySelector(".hero");
        hero.classList.remove("locked");
        hero.style.position = "relative";
        hero.style.height = "auto";

        playAudio();
      }

      function playAudio() {
        song.volume = 0.2;
        audioIconWrapper.style.display = "flex";
        song.play();
        isPlaying = true;
      }

      audioIconWrapper.onclick = function () {
        if (isPlaying) {
          song.pause();
          audioIcon.classList.remove("bi-disc");
          audioIcon.classList.add("bi-pause-circle");
        } else {
          song.play();
          audioIcon.classList.remove("bi-pause-circle");
          audioIcon.classList.add("bi-disc");
        }

        isPlaying = !isPlaying;
      };

      document.addEventListener("DOMContentLoaded", disableScroll);
    </script>

    <!-- Bootstrap JavaScript -->

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
